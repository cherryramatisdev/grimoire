#!/usr/bin/env perl

use v5.14;

use strict;
use warnings;

my @actions = `php artisan list --format=json | jq -r '.namespaces.[].commands[]'`;

if ($ENV{COMP_LINE}) {
    map {
        my $cmd = $_;
        my @parts = split(':', $cmd, 2);
        say @parts;
        /^$ARGV[1]/ and @parts > 1 and $parts[1] and say $cmd;
    } @actions;
    exit 0;
}

exec("php artisan @ARGV");
