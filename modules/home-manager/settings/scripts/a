#!/usr/bin/env perl

use v5.14;

use strict;
use warnings;

my @actions = `php artisan list --format=json | jq -r '.namespaces.[].commands[]'`;

if ($ENV{COMP_LINE}) {
    my @new_argv = @ARGV[1..$#ARGV];
    my $cmd = join("", @new_argv);

    if ($cmd ne '') {
        say "TESTE $cmd";
        @actions = grep /^$cmd/, @actions;
    }

    map { /^$cmd/ && say $_} @actions;
    exit 0;
}

exec("php artisan @ARGV");
